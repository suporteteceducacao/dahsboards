<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SPAECE Analytics Pro V14.4</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&family=OpenDyslexic&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        :root { --primary: #0f172a; --accent: #4f46e5; --sidebar-w: 280px; --bg-app: #f8fafc; --text-main: #0f172a; }
        
        body.dark-mode { --bg-app: #0f172a; --text-main: #f8fafc; }
        body.dark-mode .glass-card { background: #1e293b; border-color: #334155; color: white; }
        body.dyslexic { font-family: 'OpenDyslexic', sans-serif !important; }

        body { background-color: var(--bg-app); color: var(--text-main); font-family: 'Inter', sans-serif; overflow-x: hidden; transition: 0.3s; }

        /* --- NOVIDADE: LOGIN E LOADING --- */
        #login-overlay { position: fixed; inset: 0; z-index: 9999; background: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%); display: flex; align-items: center; justify-content: center; }
        .login-card { background: white; padding: 40px; border-radius: 32px; width: 420px; text-align: center; box-shadow: 0 25px 50px rgba(0,0,0,0.5); }
        .login-logo { width: 70px; height: 70px; background: var(--accent); color: white; border-radius: 20px; display: flex; align-items: center; justify-content: center; font-size: 28px; margin: 0 auto 20px; }
        
        #loading-screen { position: fixed; inset: 0; z-index: 9998; background: var(--bg-app); display: none; flex-direction: column; align-items: center; justify-content: center; }
        .spinner { width: 50px; height: 50px; border: 5px solid #e2e8f0; border-top-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* --- ESTRUTURA ORIGINAL PRESERVADA --- */
        .acc-bar { position: fixed; top: 15px; right: 80px; z-index: 1050; background: white; padding: 5px 15px; border-radius: 50px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; gap: 10px; border: 1px solid #e2e8f0; }
        .acc-btn { border: none; background: none; color: #64748b; cursor: pointer; font-size: 18px; padding: 5px; transition: 0.2s; }
        
        #sidebar { width: var(--sidebar-w); height: 100vh; position: fixed; top:0; left: 0; background: var(--primary); color: white; transition: 0.3s ease; z-index: 1000; padding: 20px; }
        #sidebar.collapsed { left: calc(var(--sidebar-w) * -1); }
        
        .btn-toggle { position: fixed; left: 235px; top: 15px; z-index: 1100; background: var(--accent); color: white; border: none; border-radius: 8px; width: 40px; height: 40px; display: none; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s ease; }
        #sidebar.collapsed + .btn-toggle { left: 15px; background: var(--primary); }
        #app:not([style*="display:none"]) .btn-toggle { display: flex; }

        #content { margin-left: var(--sidebar-w); transition: 0.3s ease; padding: 40px; min-height: 100vh; position: relative; padding-bottom: 80px; }
        #content.expanded { margin-left: 0; }

        .glass-card { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); margin-bottom: 25px; border: 1px solid #e2e8f0; position: relative; }
        .btn-png { position: absolute; top: 15px; right: 15px; font-size: 11px; font-weight: 800; z-index: 10; padding: 5px 12px; border-radius: 8px; border: 1px solid #e2e8f0; background: white; color: #4f46e5; cursor: pointer; }
        
        .card-critico { background-color: #ef4444; color: white; }
        .card-alerta { background-color: #facc15; color: #000; }
        .card-bom { background-color: #86efac; color: #000; }
        .card-excelente { background-color: #166534; color: white; }

        .kpi-card { background: #fff; border: 1px solid #e2e8f0; border-radius: 15px; padding: 15px; text-align: center; height: 100%; display: flex; flex-direction: column; justify-content: center; }
        .sum-card { border-radius: 15px; padding: 15px; text-align: center; min-width: 130px; }
        .val-pill { padding: 6px 14px; border-radius: 20px; font-weight: 800; font-size: 15px; display: inline-block; margin-top: 5px; }
        .val-esc { background: #eef2ff; color: #4338ca; }
        .val-mun { background: #f0fdf4; color: #15803d; }
        .val-min { background: #fef2f2; color: #b91c1c; }
        .val-max { background: #fffbeb; color: #b45309; }

        .footer-fixed { position: absolute; bottom: 0; left: 0; width: 100%; height: 60px; background: #f1f5f9; display: flex; align-items: center; justify-content: center; border-top: 1px solid #e2e8f0; color: #64748b; font-size: 12px; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="login-card">
        <div class="login-logo"><i class="fas fa-chart-line"></i></div>
        <h4 class="fw-800">SPAECE DASHBOARD</h4>
        <p class="text-muted">Acesso Seguro por INEP</p>
        <input type="text" id="inepInput" class="form-control text-center mb-3 shadow-sm" placeholder="Código INEP" style="border-radius:12px; padding:12px;">
        <button class="btn btn-primary w-100 fw-bold py-2 shadow" onclick="entrar()" style="border-radius:12px;">ACESSAR PAINEL</button>
        <div id="login-status" class="small mt-3 text-muted">Sincronizando base de dados...</div>
    </div>
</div>

<div id="loading-screen">
    <div class="spinner mb-3"></div>
    <h5 class="fw-bold">Processando informações...</h5>
</div>

<div id="app" style="display:none;">
    <div class="acc-bar">
        <button class="acc-btn" onclick="alterarFonte(1)"><i class="fas fa-plus"></i></button>
        <button class="acc-btn" onclick="alterarFonte(-1)"><i class="fas fa-minus"></i></button>
        <button class="acc-btn" onclick="toggleDyslexic()"><i class="fas fa-font"></i></button>
        <button class="acc-btn" onclick="toggleDarkMode()"><i class="fas fa-moon"></i></button>
    </div>

    <aside id="sidebar">
        <div class="mt-5 text-center mb-5"><h5 class="fw-800">DASHBOARD V14.4</h5></div>
        <label class="small fw-bold text-white-50">ETAPA</label>
        <select id="selEtapa" class="form-select bg-dark text-white border-0 mb-4" onchange="popularComponentes()"></select>
        <label class="small fw-bold text-white-50">COMPONENTE</label>
        <select id="selComp" class="form-select bg-dark text-white border-0 mb-5" onchange="render()"></select>
        
        <button class="btn btn-info w-100 fw-bold mb-3 text-white shadow-sm" onclick="abrirSumario()">SUMÁRIO EXECUTIVO</button>
        
        <button class="btn btn-danger w-100 fw-bold mb-2 shadow-sm" onclick="location.reload()">NOVA CONSULTA</button>
        <button class="btn btn-success w-100 fw-bold shadow-sm" onclick="gerarPDF()">GERAR PDF</button>
    </aside>
    
    <button class="btn btn-toggle" onclick="toggleMenu()"><i class="fas fa-bars"></i></button>

    <main id="content">
        <header class="mb-4 pt-3">
            <h2 id="hEscola" class="fw-800 text-primary mb-0">---</h2>
            <p id="hInep" class="text-muted mb-0 font-weight-bold">---</p>
        </header>

        <ul class="nav nav-pills mb-4" id="pills-tab" role="tablist">
            <li class="nav-item"><button class="nav-link active" data-bs-toggle="pill" data-bs-target="#p-prof" type="button">PROFICIÊNCIA</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#p-ide" type="button">INDICADOR IDE</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#p-comp" type="button">DESEMPENHO EM REDE</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#p-niveis" type="button">NÍVEIS DE APRENDIZAGEM</button></li>
            <li class="nav-item"><button class="nav-link" data-bs-toggle="pill" data-bs-target="#p-hist" type="button">SÉRIE HISTÓRICA</button></li>
        </ul>

        <div class="tab-content" id="pills-tabContent">
            <div class="tab-pane fade show active" id="p-prof">
                <div class="glass-card" id="c-prof">
                    <button class="btn-png" onclick="baixarPNG('c-prof','Proficiencia')"><i class="fas fa-download"></i> PNG</button>
                    <h5 class="fw-bold mb-4">Proficiência Média</h5>
                    <div style="height:400px"><canvas id="chartProf"></canvas></div>
                </div>
            </div>
            <div class="tab-pane fade" id="p-ide">
                <div class="glass-card" id="c-ide">
                    <button class="btn-png" onclick="baixarPNG('c-ide','IDE')"><i class="fas fa-download"></i> PNG</button>
                    <h5 id="titleIde" class="fw-bold mb-4">IDE</h5>
                    <div style="height:400px"><canvas id="chartIde"></canvas></div>
                </div>
            </div>
            <div class="tab-pane fade" id="p-comp"><div id="gridComparativo"></div></div>
            <div class="tab-pane fade" id="p-niveis"><div id="gridNiveis"></div></div>
            <div class="tab-pane fade" id="p-hist"><div id="gridHistorico"></div></div>
        </div>

        <footer class="footer-fixed"><span>© 2026 SPAECE DASHBOARD | Acessibilidade Digital</span></footer>
    </main>
</div>

<div class="modal fade" id="modalSumario" tabindex="-1">
    <div class="modal-dialog modal-xl">
        <div class="modal-content" style="border-radius:24px;">
            <div class="modal-header border-0 p-4">
                <h4 class="fw-800 mb-0">RELATÓRIO DE DESEMPENHO</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body p-5" id="sumario-body">
                </div>
            <div class="modal-footer border-0">
                <button class="btn btn-secondary fw-bold" data-bs-dismiss="modal">FECHAR</button>
                <button class="btn btn-success fw-bold px-4" onclick="gerarPDF()">BAIXAR PDF</button>
            </div>
        </div>
    </div>
</div>

<script>
// URL DO WEB APP (Google Apps Script)
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxj9fSRN5Vsxmf7er8u4dwv3VG1L3Iba2qg24stpzU5gA-pfttuzXgsyK03-hO9PoL_/exec";

let database = [];
let chartP = null, chartI = null;
let fontSize = 16;
Chart.register(ChartDataLabels);

// --- ACESSIBILIDADE ---
function alterarFonte(v) { fontSize += v; document.body.style.fontSize = fontSize + 'px'; }
function toggleDyslexic() { document.body.classList.toggle('dyslexic'); }
function toggleDarkMode() { document.body.classList.toggle('dark-mode'); }

// --- CARREGAMENTO DE DADOS (NOVIDADE: WEB APP) ---
async function load() {
    try {
        const response = await fetch(WEB_APP_URL);
        database = await response.json();
        document.getElementById('login-status').innerHTML = "✓ Base Conectada";
    } catch(e) {
        document.getElementById('login-status').innerHTML = "Erro ao conectar dados.";
    }
}

function toggleMenu() { 
    const side = document.getElementById('sidebar');
    const main = document.getElementById('content');
    side.classList.toggle('collapsed');
    main.classList.toggle('expanded');
    setTimeout(() => { if(chartP) chartP.resize(); if(chartI) chartI.resize(); }, 350);
}

// --- LOGIN COM LOADING (NOVIDADE) ---
function entrar() {
    const inep = document.getElementById('inepInput').value;
    const exists = database.some(d => String(d.INEP_ESC || d.INEP) === inep);

    if(exists) {
        document.getElementById('login-overlay').style.display = 'none';
        document.getElementById('loading-screen').style.display = 'flex';

        setTimeout(() => {
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('app').style.display = 'block';
            
            const etapas = [...new Set(database.filter(d => String(d.INEP_ESC || d.INEP) === inep).map(d => d.ETAPA))].sort();
            document.getElementById('selEtapa').innerHTML = etapas.map(e => `<option>${e}</option>`).join('');
            popularComponentes();
        }, 1500);
    } else {
        alert("INEP não encontrado!");
    }
}

// --- FUNÇÕES DE RENDERIZAÇÃO ORIGINAIS ---
function popularComponentes() {
    const inep = document.getElementById('inepInput').value;
    const etapa = document.getElementById('selEtapa').value;
    const comps = [...new Set(database.filter(d => String(d.INEP_ESC || d.INEP) === inep && d.ETAPA === etapa).map(d => d.COMPONENTE_CURRICULAR || d.DISCIPLINA))].sort((a,b) => b.localeCompare(a));
    document.getElementById('selComp').innerHTML = comps.map(c => `<option>${c}</option>`).join('');
    render();
}

function parse(v) { if(!v) return 0; return parseFloat(String(v).replace('%','').replace(',','.')) || 0; }

function render() {
    const inep = document.getElementById('inepInput').value;
    const etapa = document.getElementById('selEtapa').value;
    const comp = document.getElementById('selComp').value;
    const rows = database.filter(d => String(d.INEP_ESC || d.INEP) === inep && d.ETAPA === etapa && (d.COMPONENTE_CURRICULAR === comp || d.DISCIPLINA === comp)).sort((a,b) => a.EDICAO - b.EDICAO);

    document.getElementById('hEscola').innerText = rows[0].ESCOLA || rows[0].NO_MUNICIPIO;
    document.getElementById('hInep').innerText = `INEP: ${inep} | ${etapa} | ${comp}`;

    renderProf(rows);
    renderIde(rows, etapa, comp);
    renderComparacao(rows, etapa, comp);
    renderNiveis([...rows].reverse(), etapa);
    renderHistorico([...rows].reverse());
}

function renderProf(rows) {
    if(chartP) chartP.destroy();
    chartP = new Chart(document.getElementById('chartProf'), {
        type: 'bar',
        data: { labels: rows.map(r => r.EDICAO), datasets: [{ data: rows.map(r => Math.round(parse(r.PROFICIENCIA_MEDIA))), backgroundColor: '#4f46e5', borderRadius: 8 }] },
        options: { maintainAspectRatio: false, plugins: { legend: {display:false}, datalabels: { anchor:'end', align:'top', font:{weight:'800', size: 16}, formatter: Math.round } }, scales: { y: { display: false }, x: { grid: { display: false } } } }
    });
}

function renderIde(rows, etapa, comp) {
    if(chartI) chartI.destroy();
    let label = etapa.includes('2º') ? 'IDE Alfa' : (comp.includes('Port') ? 'IDE LP' : 'IDE MT');
    document.getElementById('titleIde').innerText = `Evolução: ${label}`;
    chartI = new Chart(document.getElementById('chartIde'), {
        type: 'line',
        data: { labels: rows.map(r => r.EDICAO), datasets: [{ label: label, data: rows.map(r => parse(r.IDE_ALFA) || parse(r.IDE_LP) || parse(r.IDE_MT) || parse(r.IDE) || 0), borderColor: '#10b981', tension: 0.3, fill: false, pointRadius: 7, pointBackgroundColor: '#10b981' }] },
        options: { maintainAspectRatio: false, plugins: { datalabels: { anchor:'end', align:'top', font:{weight:'800', size: 14}, formatter: v => v.toFixed(2) } }, scales: { y: { display: false }, x: { grid: { display: false } } } }
    });
}

function renderNiveis(rows, etapa) {
    const cont = document.getElementById('gridNiveis'); cont.innerHTML = '';
    const isA = etapa.includes('2º');
    rows.forEach((row, i) => {
        const id = `cn-${i}`;
        let l, v, c, soma;
        if(isA) {
            l = ['Não Alfab.', 'Incompleta', 'Interm.', 'Sufic.', 'Desej.'];
            v = [parse(row.NAO_ALFABETIZADOS), parse(row.ALFABETIZACAO_INCOMPLETA), parse(row.INTERMEDIARIO), parse(row.SUFICIENTE), parse(row.DESEJAVEL)];
            c = ['#ef4444', '#f97316', '#facc15', '#4ade80', '#166534'];
            soma = Math.round(v[3] + v[4]);
        } else {
            l = ['M. Crítico', 'Crítico', 'Interm.', 'Adequado'];
            v = [parse(row.MUITO_CRITICO), parse(row.CRITICO), parse(row.INTERMEDIARIO), parse(row.ADEQUADO)];
            c = ['#ef4444', '#facc15', '#4ade80', '#166534'];
            soma = Math.round(v[2] + v[3]);
        }
        const corCard = soma <= 25 ? 'card-critico' : (soma <= 50 ? 'card-alerta' : (soma <= 75 ? 'card-bom' : 'card-excelente'));
        cont.innerHTML += `<div class="glass-card"><div class="row align-items-center"><div class="col-md-9 border-end"><h6 class="fw-bold mb-3">Edição ${row.EDICAO}</h6><div style="height:130px"><canvas id="${id}"></canvas></div></div><div class="col-md-3"><div class="sum-card ${corCard} shadow-sm"><small class="fw-bold">APRENDIZAGEM</small><h2 class="fw-800 mb-0">${soma}%</h2></div></div></div></div>`;
        setTimeout(() => {
            new Chart(document.getElementById(id), {
                type: 'bar', data: { labels: [''], datasets: l.map((lab, idx) => ({ label: lab, data: [Math.round(v[idx])], backgroundColor: c[idx] })) },
                options: { indexAxis: 'y', maintainAspectRatio: false, plugins: { legend:{position:'bottom', labels:{font:{weight:'700'}}}, datalabels: { font:{weight:'800', size: 14}, color: (ctx) => (ctx.dataset.backgroundColor === '#ef4444' || ctx.dataset.backgroundColor === '#166534') ? '#fff' : '#000', formatter: val => val > 0 ? val+'%' : '' } }, scales: { x:{stacked:true, max:100, display:false}, y:{stacked:true, display:false} } }
            });
        }, 300);
    });
}

function renderHistorico(rows) {
    const cont = document.getElementById('gridHistorico');
    cont.innerHTML = '<h5 class="fw-bold mb-4">Evolução Histórica</h5>';
    for(let i = 0; i < rows.length - 1; i++) {
        const diff = Math.round(parse(rows[i].PROFICIENCIA_MEDIA)) - Math.round(parse(rows[i+1].PROFICIENCIA_MEDIA));
        cont.innerHTML += `<div class="glass-card p-4"><div class="row align-items-center"><div class="col-3"><b>${rows[i+1].EDICAO} → ${rows[i].EDICAO}</b></div><div class="col-4 text-center">Variação: <h3 class="fw-900 d-inline ${diff<0?'text-danger':'text-success'}">${diff>0?'+':''}${diff}</h3> pts</div><div class="col-5 text-end"><span class="badge ${diff>=0?'bg-success':'bg-danger'} p-2">${diff>=0?'CRESCIMENTO':'QUEDA'}</span></div></div></div>`;
    }
}

function renderComparacao(rowsEscola, etapa, comp) {
    const cont = document.getElementById('gridComparativo');
    cont.innerHTML = '<h5 class="fw-bold mb-4">Resultados em Rede</h5>';
    const rowsGeral = database.filter(d => d.ETAPA === etapa && (d.COMPONENTE_CURRICULAR === comp || d.DISCIPLINA === comp));
    const edicoes = [...new Set(rowsEscola.map(r => r.EDICAO))].sort((a,b) => b-a);
    edicoes.forEach(ano => {
        const esc = rowsEscola.find(r => r.EDICAO === ano);
        const redeAno = rowsGeral.filter(r => r.EDICAO === ano);
        const valMun = parse(redeAno.find(r => (r.ESCOLA || r.NO_MUNICIPIO || "").toUpperCase().includes("MARACANAU"))?.PROFICIENCIA_MEDIA || 0);
        const valEsc = parse(esc.PROFICIENCIA_MEDIA);
        const sortedProf = redeAno.map(r => parse(r.PROFICIENCIA_MEDIA)).filter(v => v > 0).sort((a,b) => a-b);
        const valMin = sortedProf[0] || 0;
        const valMax = sortedProf[sortedProf.length - 1] || 0;
        const diff = (valEsc - valMun).toFixed(0);
        cont.innerHTML += `<div class="glass-card"><div class="row align-items-center"><div class="col-md-9 border-end"><h6 class="fw-800 text-primary border-bottom pb-2 mb-3">EDIÇÃO ${ano}</h6><div class="row text-center"><div class="col-6 col-md-3">Sua Escola<br><span class="val-pill val-esc">${valEsc.toFixed(0)}</span></div><div class="col-6 col-md-3">Rede<br><span class="val-pill val-mun">${valMun.toFixed(0)}</span></div><div class="col-6 col-md-3">Mínima<br><span class="val-pill val-min">${valMin.toFixed(0)}</span></div><div class="col-6 col-md-3">Máxima<br><span class="val-pill val-max">${valMax.toFixed(0)}</span></div></div></div><div class="col-md-3"><div class="kpi-card shadow-sm"><small class="fw-bold text-muted">DIFERENÇA</small><h2 class="fw-800 mb-0 ${diff >= 0 ? 'color: #16a34a;' : 'color: #dc2626;'}"><i class="fas ${diff >= 0 ? 'fa-caret-up' : 'fa-caret-down'}"></i> ${Math.abs(diff)}</h2><small class="fw-bold ${diff >= 0 ? 'text-success' : 'text-danger'}">PONTOS</small></div></div></div></div>`;
    });
}

// --- NOVIDADE: SUMÁRIO EXECUTIVO ---
function abrirSumario() {
    const inep = document.getElementById('inepInput').value;
    const etapa = document.getElementById('selEtapa').value;
    const comp = document.getElementById('selComp').value;
    const rows = database.filter(d => String(d.INEP_ESC || d.INEP) == inep && d.ETAPA == etapa && (d.COMPONENTE_CURRICULAR == comp || d.DISCIPLINA == comp)).sort((a,b) => a.EDICAO - b.EDICAO);
    
    const ultima = rows[rows.length-1];
    
    let html = `
        <div class="text-center mb-5 border-bottom pb-4">
            <h1 class="fw-800">SUMÁRIO EXECUTIVO</h1>
            <h3 class="text-primary">${ultima.ESCOLA || 'Não informado'}</h3>
            <p>INEP: ${inep} | Etapa: ${etapa} | Componente: ${comp}</p>
        </div>
        <div class="row g-4 text-center">
            <div class="col-md-4"><div class="p-4 bg-light rounded-4 border"><h6>ÚLTIMA PROFICIÊNCIA</h6><h1 class="fw-800">${parse(ultima.PROFICIENCIA_MEDIA).toFixed(1)}</h1></div></div>
            <div class="col-md-4"><div class="p-4 bg-light rounded-4 border"><h6>IDE ${ultima.EDICAO}</h6><h1 class="fw-800">${(parse(ultima.IDE_ALFA) || parse(ultima.IDE)).toFixed(2)}</h1></div></div>
            <div class="col-md-4"><div class="p-4 bg-light rounded-4 border"><h6>PARTICIPAÇÃO</h6><h1 class="fw-800">${ultima.EFETIVO || 'N/A'}</h1></div></div>
        </div>
        <div class="mt-5 p-4 border rounded-4 bg-white shadow-sm">
            <h5 class="fw-bold">ANÁLISE COMPARATIVA</h5>
            <p>A escola apresenta um desempenho consolidado na edição ${ultima.EDICAO}. 
               O percentual de alunos em níveis satisfatórios atingiu os objetivos propostos para o componente de ${comp}.</p>
        </div>
    `;
    document.getElementById('sumario-body').innerHTML = html;
    new bootstrap.Modal(document.getElementById('modalSumario')).show();
}

async function baixarPNG(id, n) { 
    const el = document.getElementById(id);
    const canvas = await html2canvas(el, { scale: 2, backgroundColor: '#ffffff' }); 
    const link = document.createElement('a'); 
    link.download = `${n}.png`; 
    link.href = canvas.toDataURL('image/png'); 
    link.click(); 
}

async function gerarPDF() { 
    const c = await html2canvas(document.getElementById('content'), { scale: 2 }); 
    const d = new jspdf.jsPDF('p', 'mm', 'a4'); 
    d.addImage(c.toDataURL('image/png'), 'PNG', 10, 10, 190, (c.height * 190) / c.width); 
    d.save('Relatorio_SPAECE.pdf'); 
}

window.onload = load;
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
